<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- Generated by eggdoc Revision: 1.20  -->
<html>
<head>
<title>Eggs Unlimited - raw-sockets</title><style type="text/css"> <!--
      CODE {
            color: #666666;
          }
/*   DT.definition EM { font-weight: bold; font-style: normal; } */

     DT.definition { 
                   background: #eee;
                   color: black;
                   padding: 0.2em 1em 0.2em 0.7em;
                   margin-left: 0.2em;
border: 1px solid #bbc;
                   font-family: "Andale Mono", monospace;
                   /* font-size: 1.2em; */
                   
                 }
     DD {
                   margin-top: 0.8em;
                   margin-bottom: 0.8em;
     }
     DIV.subsection {
                    border-top: 1px solid #448;
                    padding-left: 1em;
                    margin-bottom: 1.2em;
     }
     DIV.subsubsection {
                    border-top: 1px dotted #99c;
                    /* border-left: 1px solid #99c; */
                    padding-left: 1em;
                    margin-bottom: 1.2em;
     }
     DIV.subsubsubsection {
                    border-top: 1px solid #ddf;
                    padding-left: 1em;
                    margin-bottom: 1.2em;
     }

	 DIV.section {
		 margin-bottom: 1.5em;
	 }
	 a:link {
		 color: #336;
	 }
	 a:visited { color: #666; }
	 a:active  { color: #966; }
	 a:hover   { color: #669; }
	 body { margin: 0; padding: 0; background: #fff; color: #000; font: 9pt "Lucida Grande", "Verdana", sans-serif; }
	 H2 {
		 background: #336;
		 color: #fff;
		 padding-top: 0.5em;
		 padding-bottom: 0.5em;
		 padding-left: 16px;
		 margin: 0 0 1em 0;
	}
	UL LI {
		list-style: none;
	}
	TT {
		font-family: "Andale Mono", monospace;
		/* font-size: 1.2em; */
	}
	H3 {
		color: #113;
		margin-bottom: 0.5em;
	}
	H4, H5, H6 {
		color: #113;
		margin-bottom: 1.0em;
	}
	H5 {
		font-weight: normal;
                font-style: italic;
		font-size: 100%;
		margin-top: 1.2em;
	}
	H6 {
		font-weight: bold;
		font-size: 85%;
		margin-top: 1.2em;
	}
     DIV#eggheader {
         text-align: center;
		 float: right;
		 margin-right: 2em;
     }
     DIV#header IMG {
            /* display: block; margin-left: auto; margin-right: auto;  */
            /* float: right; */
            border: none;  /* firefox */
     }
     DIV#footer {
                background: #bbd;
                padding: 0.7em ;
                border-top: 1px solid #cce;
     }
     DIV#footer hr {
                display: none;
     }
     DIV#footer a {
                float: left;
     }
     DIV#revision-history {
         float: right;
     }
     
     DIV#body {
		 margin: 1em 1em 1em 16px;
	 }

     DIV#examples PRE {
       background: #eef;
       padding: 0.1em;
       border: 1px solid #aac;
     }
     PRE#license, DIV#examples PRE {
       padding: 0.5em;
     }
     DIV#examples PRE {
       /* font-size: 85%; */
     }
     PRE { font-family: "Andale Mono", monospace; }
     TABLE {
       background: #eef;
       padding: 0.2em;
       border: 1px solid #aac;
       border-collapse: collapse;
       width: 100%;
     }
     TABLE.symbol-table TD.symbol {
          width: 15em;
          font-family: "Andale Mono", monospace;
          /* font-size: 1.2em; */
     }
     TH {
       text-align: left;
       border-bottom: 1px solid #aac;
       padding: 0.25em 0.5em 0.25em 0.5em;
     } 
     TD { padding: 0.25em 0.5em 0.25em 0.5em; }
     --></style></head>
<body>
<div id="header">
<h2>raw-sockets</h2>
<div id="eggheader"><a href="index.html">
<img src="egg.jpg" alt="[Picture of an egg]" /></a></div></div>
<div id="body">
<div class="section">
<h3>Description</h3>
<p>UNIX raw socket interface</p></div>
<div class="section">
<h3>Author</h3>
<p><a href="mailto:elf@ephemeral.net">Elf</a>,<a href="mailto:bk2@alum.wpi.edu">Benjamin L. Kurtz</a></p></div>
<div class="section">
<h3>Requires</h3>
<ul>
<li><a href="srfi-66.html">srfi-66</a></li></ul></div>
<div class="section">
<h3>Version</h3>
<ul>
<li>1.0 Initial release (Ben Kurtz)</li>
<li>2.0 Refactored and cleaned (Elf)</li>
<li>2.1 Added non-blocking reads (Elf)</li>
<li>3.0 Changed read/write semantics, added buffering of packets, switched to SIGIO instead of polling (Elf)</li></ul></div>
<div class="section">
<h3>Usage</h3><tt>(require-extension raw-sockets)</tt></div>
<div class="section">
<h3>Download</h3><a href="raw-sockets.egg">raw-sockets.egg</a></div>
<div class="section">
<h3>Documentation</h3>
<p>This egg provides an interface to packet sockets.</p>
<p>Packet sockets are even less cooked than &quot;raw&quot; sockets, allowing manual setting of Layer 2 fields.</p>
<p>Currently, there is support for Linux and OS X.  If you want something else, send us the code for getting packet sockets.</p>
<div class="section">
<h3>Opening and querying a packet socket</h3>
<dl>
<dt class="definition"><strong>procedure:</strong> (open-raw-socket INTERFACE)</dt>
<dd>
<p>Creates a new raw-socket object.  <tt>INTERFACE</tt> is the name of the network interface, given as a string.</p>
<p>Note: Upon creation of the first raw socket, a SIGIO handler will be installed.  If a handler already exists, it will still be called after the new handler, if the new handler is not applicable.</p></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket? OBJ)</dt>
<dd>
<p>Returns #t if OBJ is a raw-socket.</p></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket-open? OBJ)</dt>
<dd>
<p>Returns #t if OBJ is an open raw-socket, i.e. data can be read from or written to it.</p></dd></dl></div>
<div class="section">
<h3>Information on a packet socket</h3>
<dl>
<dt class="definition"><strong>procedure:</strong> (raw-socket-domain OBJ)</dt>
<dd></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket-type OBJ)</dt>
<dd></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket-protocol OBJ)</dt>
<dd>
<p>Returns the socket domain/type/protocol associated with this raw-socket.</p></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket-fd OBJ)</dt>
<dd>
<p>Returns the file descriptor associated with this raw-socket.</p></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket-saddr OBJ)</dt>
<dd>
<p>Returns a pair (saddr . size) for the sockaddr structure and length of this raw-socket.</p></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket-iface OBJ)</dt>
<dd>
<p>Returns the interface associated with this raw-socket.</p></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket-mtu OBJ)</dt>
<dd>
<p>Returns the MTU for this raw-socket.  On MacOS, this is 1 less than the actual MTU size because of its broken network stack.</p></dd></dl></div>
<div class="section">
<h3>Writing to a packet socket</h3>
<dl>
<dt class="definition"><strong>procedure:</strong> (raw-socket-send RAW-SOCKET PACKET)</dt>
<dd>
<p>Writes to the given raw socket.  <tt>PACKET</tt> may be a u8vector or string.</p>
<p>Note: if the socket is not ready for writing, the packet will be queued until writing is allowed or until the socket closes.</p></dd></dl></div>
<div class="section">
<h3>Reading from a packet socket</h3>
<p>Reading from raw sockets is not done directly; instead, receiver procedures are installed.  These procedure(s) get called whenever data is available for reading on the socket.  Receiver procedures take the form: </p>
<p>(RECEIVER-PROC DATA LENGTH)</p>
<p><tt>RECEIVER-PROC</tt> is the the procedure's name, 
<br /><tt>DATA</tt> is the received data as a u8vector, and 
<br /><tt>LENGTH</tt> is the length of DATA.</p>
<p>Multiple receiver procedures can be installed, and will be called in most-recently-added-first order.</p>
<dl>
<dt class="definition"><strong>procedure:</strong> (raw-socket-add-recver RAW-SOCKET LABEL HANDLER)</dt>
<dd>
<p>Adds a receiver procedure to RAW-SOCKET.  <tt>HANDLER</tt> is a receiver procedure, as detailed above.  <tt>LABEL</tt> is a string for referencing the handler.  If LABEL already has an associated procedure, it is replaced without changing the ordering.</p></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket-del-recver RAW-SOCKET LABEL)</dt>
<dd>
<p>Removes a receiver procedure from RAW-SOCKET.  This does nothing if the label does not have an associated handler.</p></dd>
<dt class="definition"><strong>procedure:</strong> (raw-socket-recvers RAW-SOCKET)</dt>
<dd>
<p>Returns an ordered list of (LABEL . HANDLER) pairs corresponding to all receiver procedures for RAW-SOCKET.</p></dd></dl></div>
<div class="section">
<h3>Closing a packet socket</h3>
<dl>
<dt class="definition"><strong>procedure:</strong> (close-raw-socket RAW-SOCKET)</dt>
<dd>
<p>Closes the given raw socket.</p>
<p>This also resets the promiscuous mode to its original value for that interface, and clears the signal handler if there are no other interfaces assigned to that signal.</p></dd></dl></div>
<div class="section">
<h3>Bugs</h3>
<p>None known.</p></div>
<div class="section">
<h3>Licence</h3>
<pre>Copyright (C) 2007, Lenny Frank and Benjamin L. Kurtz.  All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the Software),
to deal in the Software without restriction, including without limitation 
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the 
Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED AS-IS, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR 
OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

</pre></div></div></div>
<div id="footer">
<hr /><a href="index.html">&lt; Egg index</a>
<div id="revision-history">$Revision$ $Date$</div>&nbsp;</div></body></html>